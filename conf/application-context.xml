<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:context="http://www.springframework.org/schema/context"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:mvc="http://www.springframework.org/schema/mvc"
   xsi:schemaLocation="
        http://www.springframework.org/schema/beans     
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc.xsd">

    <context:annotation-config base-package="controllers,filters,interceptors,models,org.sagebionetworks.bridge"/>
    <bean class="org.sagebionetworks.bridge.config.BridgeSpringConfig" />

    <bean id="sendEmailViaAmazonService" class="org.sagebionetworks.bridge.services.SendMailViaAmazonService">
        <property name="fromEmail" value="support@sagebridge.org" />
    </bean>
    
    <bean id="numAsyncWorkerThreads" class="java.lang.Integer">
        <constructor-arg value="20" />
    </bean>
    
    <bean id="accountDao" class="org.sagebionetworks.bridge.stormpath.StormpathAccountDao">
        <property name="encryptors">
            <list>
                <ref bean="healthCodeEncryptor"/>
            </list>
        </property>
    </bean>

    <bean id="BaseController" class="controllers.BaseController" abstract="true"/>
    
    <bean id="AdminController" class="controllers.AdminController" abstract="true" parent="BaseController"/>
    
    <bean id="proxiedController" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyTargetClass" value="true"/>
        <property name="interceptorNames">
            <list>
                <value>loggingInterceptor</value>
                <value>exceptionInterceptor</value>
            </list>
        </property>
    </bean>
    
    <bean id="controllers.ApplicationController" parent="proxiedController">
        <property name="target">
            <bean class="controllers.ApplicationController" parent="BaseController">
            </bean>
        </property>
    </bean>

    <bean id="controllers.AuthenticationController" parent="proxiedController">
        <property name="target">
            <bean class="controllers.AuthenticationController" parent="BaseController">
            </bean>
        </property>
    </bean>

    <bean id="controllers.HealthDataController" parent="proxiedController">
        <property name="target">
            <bean class="controllers.HealthDataController" parent="BaseController" />
        </property>
    </bean>

    <bean id="controllers.UserProfileController" parent="proxiedController">
        <property name="target" ref="controllers.UserProfileController"/>
        <!-- 
            <bean class="controllers.UserProfileController" parent="BaseController">
                <property name="userProfileService" ref="userProfileService"/>
                <property name="viewCache" ref="viewCache"/>
            </bean>
        </property>
         -->
    </bean>

    <bean id="controllers.UploadSchemaController" parent="proxiedController">
        <property name="target">
            <bean class="controllers.UploadSchemaController" parent="BaseController" />
        </property>
    </bean>

    <bean id="controllers.ConsentController" parent="proxiedController">
        <property name="target">
            <bean class="controllers.ConsentController" parent="BaseController">
                <property name="consentService" ref="consentService" />
                <property name="optionsService" ref="optionsService" />
            </bean>
        </property>
    </bean>
    
    <bean id="controllers.ScheduleController" parent="proxiedController">
        <property name="target">
            <bean class="controllers.ScheduleController" parent="BaseController">
                <property name="schedulePlanService" ref="schedulePlanService" />
            </bean>
        </property>
    </bean>
    
    <bean id="controllers.BackfillController" parent="proxiedController">
        <property name="target">
            <bean class="controllers.BackfillController" parent="AdminController" />
        </property>
    </bean>

    <bean id="controllers.StudyConsentController" parent="proxiedController">
        <property name="target">
            <bean class="controllers.StudyConsentController" parent="AdminController">
                <property name="studyConsentService" ref="studyConsentService" />
            </bean>
        </property>
    </bean>

    <bean id="controllers.SurveyController" parent="proxiedController">
        <property name="target">
            <bean class="controllers.SurveyController" parent="BaseController">
                <property name="surveyService" ref="surveyService" />
                <property name="viewCache" ref="viewCache" />
            </bean>
        </property>
    </bean>

    <bean id="controllers.UploadController" parent="proxiedController">
        <property name="target">
            <bean class="controllers.UploadController" parent="BaseController">
                <property name="uploadService" ref="uploadService" />
            </bean>
        </property>
    </bean>

    <bean id="controllers.SurveyResponseController" parent="proxiedController">
        <property name="target">
            <bean class="controllers.SurveyResponseController" parent="BaseController">
                <property name="surveyResponseService" ref="surveyResponseService" />
            </bean>
        </property>
    </bean>
    
    <bean id="controllers.UserManagementControler" parent="proxiedController">
        <property name="target">
            <bean class="controllers.UserManagementController" parent="AdminController">
                <property name="userAdminService" ref="userAdminService" />
            </bean>
        </property>
    </bean>    

    <bean id="controllers.SchedulePlanController" parent="proxiedController">
        <property name="target">
            <bean class="controllers.SchedulePlanController" parent="BaseController">
                <property name="schedulePlanService" ref="schedulePlanService" />
            </bean>
        </property>
    </bean>
    
    <bean id="controllers.StudyController" parent="proxiedController">
        <property name="target">
            <bean class="controllers.StudyController" parent="BaseController">
                <property name="userProfileService" ref="userProfileService" />
            </bean>
        </property>
    </bean>
    
    <bean id="controllers.CacheAdminController" parent="proxiedController">
        <property name="target">
            <bean class="controllers.CacheAdminController" parent="BaseController">
                <property name="cacheAdminService" ref="cacheAdminService" />
            </bean>
        </property>
    </bean>

    <bean id="controllers.LunchController" parent="proxiedController">
        <property name="target">
            <bean class="controllers.LunchController" parent="BaseController" />
        </property>
    </bean>
</beans>
